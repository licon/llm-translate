# LLM-Translate 插件需求文档

本文档详细描述了 LLM-Translate 浏览器插件的功能性与非功能性需求。

## 1. 功能需求 (Functional Requirements)

### 1.1. 划词翻译

*   **触发方式:** 用户在网页上用鼠标选中一段文本后，旁边应出现一个小的翻译图标。
*   **显示方式:** 点击翻译图标后，弹出一个独立的、设计简洁的浮窗（Overlay）来展示翻译结果。
*   **浮窗内容:**
    *   显示原文和译文。
    *   提供“复制译文”按钮。
    *   显示当前的目标语言，并允许快速切换。
*   **交互:** 浮窗不应遮挡过多原文，且用户可以轻松关闭。

### 1.2. 全文翻译

*   **触发方式:** 用户点击浏览器工具栏中的插件图标，在弹出的主面板中点击“翻译本页”按钮。
*   **执行过程:**
    *   插件应自动检测当前页面的主要语言。
    *   调用 LLM API 对页面中的所有文本节点进行翻译。
    *   在不破坏页面布局的前提下，将原文替换为译文。
*   **状态提示:** 页面顶部应出现一个提示栏，告知用户“此页面已翻译”，并提供“显示原文”的选项。

### 1.3. 插件主面板 (点击工具栏图标)

*   **主要功能:**
    *   提供一个文本输入框，允许用户手动输入或粘贴文本进行翻译。
    *   提供“翻译本页”的快捷按钮。
    *   提供一个下拉菜单，用于设定默认的目标翻译语言。
    *   提供一个指向“设置”页面的链接或按钮。

### 1.4. 设置页面

*   **API 配置:**
    *   提供输入框，让用户可以安全地输入并保存自己的 LLM API 密钥。
    *   允许用户选择要使用的 LLM 模型（如 Gemini, GPT-4 等）。
*   **语言管理:**
    *   允许用户自定义目标语言列表，方便在划词翻译和主面板中快速切换。
*   **功能开关:**
    *   提供开关，允许用户启用或禁用“划词后自动弹出图标”功能。

## 2. 非功能性需求 (Non-Functional Requirements)

*   **性能 (Performance):**
    *   插件对浏览器性能的影响应降至最低，不能导致页面卡顿。
    *   API 请求必须是异步的，不能阻塞用户界面。
    *   对于同一页面内重复的文本，应进行缓存，避免不必要的 API 调用。
*   **界面与体验 (UI/UX):**
    *   所有界面元素（浮窗、主面板、设置页）都应设计简洁、直观、易于使用。
    *   视觉风格应与现代浏览器设计保持一致。
*   **安全 (Security):**
    *   用户的 API 密钥必须使用 `chrome.storage.local` 或同等安全机制加密存储在本地，绝不能上传到任何服务器。
    *   所有与 LLM API 的通信都必须通过 HTTPS 进行。
*   **兼容性 (Compatibility):**
    *   插件需要兼容所有遵循 `WebExtensions API` 的主流浏览器，包括 Google Chrome, Mozilla Firefox, Microsoft Edge 的最新版本。

## 3. 未来规划 (Future Enhancements)

*   **图片翻译:** 支持识别并翻译网页图片中的文字（OCR）。
*   **语音输入:** 允许用户通过语音输入进行翻译。
*   **历史记录:** 保存用户的翻译历史，方便回顾。
*   **高级提示词:** 允许高级用户自定义 Prompt，以实现不同风格（如正式、口语化、技术）的翻译。
